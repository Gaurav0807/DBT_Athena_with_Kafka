# ðŸ“Š Data Quality & Monitoring Architecture

## Complete Pipeline Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  KAFKA â†’ S3 â†’ DBT â†’ ATHENA PIPELINE                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  KAFKA PRODUCER LAYER                                    â”‚
    â”‚  (Sends cryptocurrency data to Kafka topic)              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  KAFKA TOPIC: selected_crypto_data                       â”‚
    â”‚  - Stores: BTC, ETH, XRP prices & details                â”‚
    â”‚  â—„â”€â”€â”€ MONITORING: Kafka Consumer Lag tracked             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  ENHANCED KAFKA CONSUMER (kafka/consumer.py)             â”‚
    â”‚  â”œâ”€ Batches messages (100 per batch)                     â”‚
    â”‚  â”œâ”€ Error handling & retry logic                         â”‚
    â”‚  â”œâ”€ Structured logging (timestamps, metrics)             â”‚
    â”‚  â”œâ”€ Metrics: throughput, upload time, errors             â”‚
    â”‚  â””â”€ Publishes to CloudWatch                              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  AWS S3 BUCKET: gaurav-hudi-data                          â”‚
    â”‚  â”œâ”€ Partitioned: crypto_data/year/month/day/             â”‚
    â”‚  â”œâ”€ Format: JSON files (1 per batch)                     â”‚
    â”‚  â””â”€ â—„â”€â”€â”€ MONITORING: S3 object count, ingestion rate     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  ATHENA EXTERNAL TABLE: crypto_raw_data                  â”‚
    â”‚  â””â”€ Queries S3 data using SQL                            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                             â”‚
           â–¼                             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  DBT TRANSFORMATIONSâ”‚     â”‚  DATA QUALITY TESTS  â”‚
    â”‚  (Bronze/Silver/Gold)      â”‚  (dbt test)          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                           â”‚
    â–¼                                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BRONZE LAYER        â”‚           â”‚ BRONZE TESTS         â”‚
â”‚ (crypto_raw)        â”‚           â”‚ â”œâ”€ not_null          â”‚
â”‚ â”œâ”€ Raw Kafka data   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€ unique            â”‚
â”‚ â”œâ”€ Minimal parsing  â”‚           â”‚ â”œâ”€ not_empty_string  â”‚
â”‚ â””â”€ As-is format     â”‚           â”‚ â”œâ”€ price_in_range    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ â””â”€ no_duplicate_ids  â”‚
           â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SILVER LAYER        â”‚           â”‚ SILVER TESTS         â”‚
â”‚ (crypto_stage)      â”‚           â”‚ â”œâ”€ not_null          â”‚
â”‚ â”œâ”€ Cleaned data     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€ unique            â”‚
â”‚ â”œâ”€ Validated        â”‚           â”‚ â”œâ”€ accepted_values   â”‚
â”‚ â”œâ”€ Transformations  â”‚           â”‚ â”œâ”€ not_empty_string  â”‚
â”‚ â””â”€ Business rules   â”‚           â”‚ â”œâ”€ price_in_range    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ â””â”€ recency_check     â”‚
           â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GOLD LAYER          â”‚           â”‚ GOLD TESTS           â”‚
â”‚ (crypto_curated)    â”‚           â”‚ â”œâ”€ not_null          â”‚
â”‚ â”œâ”€ Analytics ready  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€ unique            â”‚
â”‚ â”œâ”€ Business metrics â”‚           â”‚ â”œâ”€ not_empty_string  â”‚
â”‚ â”œâ”€ Aggregations     â”‚           â”‚ â”œâ”€ price_in_range    â”‚
â”‚ â””â”€ KPI dashboard    â”‚           â”‚ â”œâ”€ recency_check     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ â””â”€ freshness (2h)    â”‚
           â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  ANALYTICS & BI TOOLS                                    â”‚
    â”‚  - Tableau/Power BI dashboards                           â”‚
    â”‚  - Analytics queries                                     â”‚
    â”‚  - Business intelligence                                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Monitoring & Observability Layer

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     MONITORING FRAMEWORK                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   DATA QUALITY TESTS (dbt)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  ðŸ“‹ GENERIC TESTS (Reusable across models):                         â”‚
â”‚  â”œâ”€ not_empty_string()      â†’ Prevents empty string values          â”‚
â”‚  â”œâ”€ price_in_range()        â†’ Validates price within bounds         â”‚
â”‚  â”œâ”€ recency_check()         â†’ Detects data older than N days        â”‚
â”‚  â””â”€ no_duplicate_ids()      â†’ Prevents duplicate IDs in timewindow  â”‚
â”‚                                                                       â”‚
â”‚  ðŸ“‹ BUILT-IN TESTS:                                                  â”‚
â”‚  â”œâ”€ not_null                â†’ No NULL values allowed                â”‚
â”‚  â”œâ”€ unique                  â†’ No duplicate values                    â”‚
â”‚  â”œâ”€ accepted_values         â†’ Only specific values allowed           â”‚
â”‚  â””â”€ relationships           â†’ Foreign key validation                 â”‚
â”‚                                                                       â”‚
â”‚  ðŸ“‹ FRESHNESS CHECKS:                                                â”‚
â”‚  â”œâ”€ Gold layer: Error after 2 hours without update                  â”‚
â”‚  â”œâ”€ Silver layer: Warn after 3 days                                 â”‚
â”‚  â””â”€ Bronze layer: Warn after 7 days                                 â”‚
â”‚                                                                       â”‚
â”‚  TEST EXECUTION:                                                     â”‚
â”‚  â””â”€ Run: dbt test -s crypto_raw,crypto_stage,crypto_curated         â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  LOGGING & ALERTING                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  ðŸ“ STRUCTURED LOGGING:                                              â”‚
â”‚  â”œâ”€ Consumer logs           (kafka/consumer.py)                      â”‚
â”‚  â”‚  â””â”€ Format: timestamp, level, message, metrics                   â”‚
â”‚  â”œâ”€ Monitoring logs         (monitoring/data_quality_monitor.py)     â”‚
â”‚  â”‚  â””â”€ Format: Kafka lag, S3 count, errors                          â”‚
â”‚  â””â”€ dbt logs                (target/logs/)                           â”‚
â”‚     â””â”€ Format: Test results, SQL queries, timing                    â”‚
â”‚                                                                       â”‚
â”‚  ðŸš¨ ALERT CONDITIONS:                                                â”‚
â”‚  â”œâ”€ Kafka Lag > 1000 messages                                        â”‚
â”‚  â”œâ”€ dbt test failures (any)                                          â”‚
â”‚  â”œâ”€ Upload errors > 5                                                â”‚
â”‚  â”œâ”€ Data staleness > 2 hours (Gold layer)                            â”‚
â”‚  â”œâ”€ Throughput < baseline                                            â”‚
â”‚  â””â”€ S3 upload duration > 30 seconds                                  â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


## Data Flow with Layer Details

```
KAFKA TOPIC (selected_crypto_data)
    â”‚ Format: JSON (id, symbol, name, price, last_updated)
    â”‚ Batch size: 100 messages per upload
    â”‚
    â–¼
KAFKA CONSUMER + METRICS LOGGING
    â”‚ â”œâ”€ Validates message format
    â”‚ â”œâ”€ Batches messages (100 per batch)
    â”‚ â”œâ”€ Tracks: consumed count, upload time, errors
    â”‚ â””â”€ Publishes to CloudWatch
    â”‚
    â–¼
S3 BUCKET (gaurav-hudi-data/crypto_data/)
    â”‚ Structure: year/month/day/crypto_data_HH-MM-SS.json
    â”‚ Contains: Raw JSON arrays from Kafka
    â”‚
    â–¼
ATHENA EXTERNAL TABLE (crypto_raw_data)
    â”‚ Query: SELECT from S3 using SQL
    â”‚ Location: s3://gaurav-hudi-data/crypto_data/
    â”‚
    â–¼
DBT BRONZE LAYER (crypto_raw)
    â”‚ Action: Minimal transformation (just reformatted)
    â”‚ Tests: 11 total (null, unique, empty string, price range, etc.)
    â”‚
    â–¼
DBT SILVER LAYER (crypto_stage)
    â”‚ Action: Clean, validate, apply business rules
    â”‚ Tests: 11 total (null, unique, range, recency, etc.)
    â”‚
    â–¼
DBT GOLD LAYER (crypto_curated)
    â”‚ Action: Analytics-ready aggregations & metrics
    â”‚ Tests: 11 total (freshness < 2h guarantee)
    â”‚
    â–¼
ANALYTICS & BI
    â””â”€ Dashboards, reports, insights
```



## Deployment Architecture

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Your Workspace    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                      â”‚                      â”‚
        â–¼                      â–¼                      â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Kafka  â”‚          â”‚   S3   â”‚          â”‚ Athena   â”‚
    â”‚        â”‚          â”‚ Bucket â”‚          â”‚          â”‚
    â””â”€â”¬â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                           â–²
      â”‚  Messages                                 â”‚
      â”‚                                      SQL Query
      â–¼                                           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”
    â”‚  Enhanced Consumer (kafka/consumer.py)      â”‚      â”‚
    â”‚  â”œâ”€ Batch messages (100)                   â”‚      â”‚
    â”‚  â”œâ”€ Upload to S3                           â”‚      â”‚
    â”‚  â”œâ”€ Track metrics                          â”‚      â”‚
    â”‚  â””â”€ Publish to CloudWatch â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
                                         â”‚              â”‚
                                    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”       â”‚
                                    â”‚CloudWatch â”‚       â”‚
                                    â”‚Metrics    â”‚       â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
                                                        â”‚
                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  dbt Models + Tests (aws_dbt/)                    â”‚
    â”‚  â”œâ”€ Bronze: crypto_raw (raw data)                â”‚
    â”‚  â”œâ”€ Silver: crypto_stage (staged & validated)    â”‚
    â”‚  â””â”€ Gold: crypto_curated (ready for analytics)   â”‚
    â”‚                                                    â”‚
    â”‚  Tests Running:                                   â”‚
    â”‚  â”œâ”€ Null checks                                   â”‚
    â”‚  â”œâ”€ Uniqueness validation                         â”‚
    â”‚  â”œâ”€ Business rule validation                      â”‚
    â”‚  â””â”€ Data freshness                                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Gold Layer   â”‚
                    â”‚ Analytics    â”‚
                    â”‚ Ready Data   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```